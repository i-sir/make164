<include file="public@header"/></head>
<style>
    /* 设置地图容器的样式，使其占满页面宽度，并具有一定高度 */
    #map {
        width: 100%;
        height: 600px;
    }
</style>

<body>
<div class="form-group">

    <div class="layui-input-block col-md-7 col-sm-10">
        <div id="map"></div>
    </div>
    <div class="layui-input-block col-md-4 col-sm-10">
        <foreach name="list" item="vo">
            <div>
                <p>操作说明:{$vo.operate_name}</p>
                <p>详细地址:{$vo.address}</p>
                <p>创建时间:{$vo.create_time|date='Y-m-d H:i:s'}</p>
            </div>
            <br>
            <br>
            <br>
        </foreach>
    </div>
</div>


<script src="__STATIC__/js/admin.js"></script>
</body>
</html>

<script src="https://webapi.amap.com/maps?v=2.0&key=519a8b21024bd9c2f3b49ebe259a515b"></script>
<script>

    var value_center = {$center};
    var value_coordinates = {$coordinates};
    var value_pointNames = {$pointNames};

    // 创建地图实例
    var map = new AMap.Map('map', {
        zoom: 13, // 地图缩放级别，可根据实际情况调整
        center: value_center  // 地图初始中心坐标，示例值，可替换为合适的坐标
    });

    // 定义经纬度数据（示例数据，可替换为真实需要绘制线路经过的坐标点）
    var coordinates = value_coordinates;

    var pointNames = value_pointNames;
    // 绘制线路（使用折线组件）
    var polyline = new AMap.Polyline({
        path: coordinates, // 使用定义好的坐标数组作为路径
        strokeColor: "#3366FF", // 线条颜色，可自定义
        strokeWeight: 6, // 线条宽度，可调整
        strokeOpacity: 1 // 线条透明度，取值范围0 - 1
    });

    map.add(polyline); // 将折线添加到地图上显示线路

    // 循环添加经纬度点的标注，修正闭包问题
    for (var i = 0; i < coordinates.length; i++) {
        (function (index) {
            var marker = new AMap.Marker({
                position: coordinates[index],
                map: map
            });
            var infoWindow = new AMap.InfoWindow({
                content: pointNames[index]
            });
            marker.on('click', function () {
                infoWindow.open(map, this.getPosition());
            });
        })(i);
    }


</script>
